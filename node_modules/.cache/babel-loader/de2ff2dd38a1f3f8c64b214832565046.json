{"ast":null,"code":"import _taggedTemplateLiteral from\"/home/kamalesh/Downloads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _toConsumableArray from\"/home/kamalesh/Downloads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/home/kamalesh/Downloads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/kamalesh/Downloads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/kamalesh/Downloads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function _templateObject11(){var data=_taggedTemplateLiteral([\"\\nfont-size:15px;\\nwidth:200px;\\npadding:5px;\\ncolor: #a833b9;\\nbackground-color: #37103d;\\nborder:1px solid #a833b9;\\ntext-align:center;\\nborder-radius:50px;\\ncursor:pointer;\\n:hover {\\n    color:#fff;\\n    background-color:#a833b9;  \\n\\n}\\n@media (max-width:425px){\\n  font-size:12px;\\n  width:150px;\\n  text-align:center;\\n  }\\n\"]);_templateObject11=function _templateObject11(){return data;};return data;}function _templateObject10(){var data=_taggedTemplateLiteral([\"\\nfont-size:15px;\\nwidth:200px;\\npadding:5px;\\ncolor:#fff;\\ntext-align:center;\\nbackground-color: #a833b9;\\nborder-radius:50px;\\ncursor:pointer;\\n:hover {\\n    color:#a833b9;\\n    background-color: #fff;\\n  }\\n  @media (max-width:425px){\\n    font-size:12px;\\n    width:150px;\\n    text-align:center;\\n    }\\n\"]);_templateObject10=function _templateObject10(){return data;};return data;}function _templateObject9(){var data=_taggedTemplateLiteral([\"\\ncolor:yellow;\\n\"]);_templateObject9=function _templateObject9(){return data;};return data;}function _templateObject8(){var data=_taggedTemplateLiteral([\"\\nposition: absolute;\\ndisplay:none;\\n\"]);_templateObject8=function _templateObject8(){return data;};return data;}function _templateObject7(){var data=_taggedTemplateLiteral([\"\\n  display: none;\\n  position: absolute;\\n  cursor:pointer;\\n  left: 15px;\\n  top: 15px;\\n\"]);_templateObject7=function _templateObject7(){return data;};return data;}function _templateObject6(){var data=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  font-size:17px;\\n  font-weight:500;\\n  color:#fff;\\n  width:fit-content;\\n  padding:5px;\\n  border-radius:5px;\\n  margin-left:auto;\\n  margin-right:auto;\\n  bottom: 5px;\\n  @media (max-width:425px){\\n    font-size:12px;\\n    bottom: 2px;\\n    }\\n\"]);_templateObject6=function _templateObject6(){return data;};return data;}function _templateObject5(){var data=_taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  flex-wrap: wrap;\\n  justify-content: center;\\n  align-items: center;\\n  > video {\\n    top: 0;\\n    left: 0;\\n    width: 100%;\\n    height: 100%;\\n  }\\n\\n  :hover {\\n  \\n    > i,div  {\\n      display: block;\\n    }\\n\\n  }\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteral([\" \\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 100%;\\n  // height:100%!important;\\n\\n  // @media (max-width:425px){\\n    \\n  //   height:0%!important;\\n\\n  // }\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  max-width: 100%;\\n  display: flex;\\n  flex-wrap:wrap;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  width: 100%;\\n  max-height: 100vh;\\n  flex-direction: row;\\n  height: calc(100vh - 77px)!important;\\n  min-height: calc(100vh - 77px)!important;\\n  max-height: calc(100vh - 77px)!important;\\n  margin-top: 0!important;\\n\\n@media (max-width:425px){\\n  display: block;\\n}\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect,useRef}from'react';import Peer from'simple-peer';import styled from'styled-components';import socket from'../../socket';import VideoCard from'../Video/VideoCard';import BottomBar from'../BottomBar/BottomBar';import Chat from'../Chat/Chat';import'../../App.css';// import Link from 'react-router-dom';\nvar Room=function Room(props){var currentUser=sessionStorage.getItem('user');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),peers=_useState2[0],setPeers=_useState2[1];var _useState3=useState({localUser:{video:true,audio:true}}),_useState4=_slicedToArray(_useState3,2),userVideoAudio=_useState4[0],setUserVideoAudio=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),videoDevices=_useState6[0],setVideoDevices=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),displayChat=_useState8[0],setDisplayChat=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),screenShare=_useState10[0],setScreenShare=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showVideoDevices=_useState12[0],setShowVideoDevices=_useState12[1];var peersRef=useRef([]);var userVideoRef=useRef();var screenTrackRef=useRef();var userStream=useRef();var roomId=props.match.params.roomId;useEffect(function(){// Get Video Devices\nnavigator.mediaDevices.enumerateDevices().then(function(devices){var filtered=devices.filter(function(device){return device.kind==='videoinput';});setVideoDevices(filtered);});// Set Back Button Event\nwindow.addEventListener('popstate',goToBack);// Connect Camera & Mic\nnavigator.mediaDevices.getUserMedia({video:true,audio:true}).then(function(stream){userVideoRef.current.srcObject=stream;userStream.current=stream;socket.emit('BE-join-room',{roomId:roomId,userName:currentUser});socket.on('FE-user-join',function(users){// all users\nvar peers=[];users.forEach(function(_ref){var userId=_ref.userId,info=_ref.info;var userName=info.userName,video=info.video,audio=info.audio;if(userName!==currentUser){var peer=createPeer(userId,socket.id,stream);peer.userName=userName;peer.peerID=userId;peersRef.current.push({peerID:userId,peer:peer,userName:userName});peers.push(peer);setUserVideoAudio(function(preList){return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peer.userName,{video:video,audio:audio}));});}});setPeers(peers);});socket.on('FE-receive-call',function(_ref2){var signal=_ref2.signal,from=_ref2.from,info=_ref2.info;var userName=info.userName,video=info.video,audio=info.audio;var peerIdx=findPeer(from);if(!peerIdx){var peer=addPeer(signal,from,stream);peer.userName=userName;peersRef.current.push({peerID:from,peer:peer,userName:userName});setPeers(function(users){return[].concat(_toConsumableArray(users),[peer]);});setUserVideoAudio(function(preList){return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peer.userName,{video:video,audio:audio}));});}});socket.on('FE-call-accepted',function(_ref3){var signal=_ref3.signal,answerId=_ref3.answerId;var peerIdx=findPeer(answerId);peerIdx.peer.signal(signal);});socket.on('FE-user-leave',function(_ref4){var userId=_ref4.userId,userName=_ref4.userName;var peerIdx=findPeer(userId);peerIdx.peer.destroy();setPeers(function(users){users=users.filter(function(user){return user.peerID!==peerIdx.peer.peerID;});return _toConsumableArray(users);});peersRef.current=peersRef.current.filter(function(_ref5){var peerID=_ref5.peerID;return peerID!==userId;});});});socket.on('FE-toggle-camera',function(_ref6){var userId=_ref6.userId,switchTarget=_ref6.switchTarget;var peerIdx=findPeer(userId);setUserVideoAudio(function(preList){var video=preList[peerIdx.userName].video;var audio=preList[peerIdx.userName].audio;if(switchTarget==='video')video=!video;else audio=!audio;return _objectSpread(_objectSpread({},preList),{},_defineProperty({},peerIdx.userName,{video:video,audio:audio}));});});return function(){socket.disconnect();};// eslint-disable-next-line\n},[]);function createPeer(userId,caller,stream){var peer=new Peer({initiator:true,trickle:false,stream:stream});peer.on('signal',function(signal){socket.emit('BE-call-user',{userToCall:userId,from:caller,signal:signal});});peer.on('disconnect',function(){peer.destroy();});return peer;}function addPeer(incomingSignal,callerId,stream){var peer=new Peer({initiator:false,trickle:false,stream:stream});peer.on('signal',function(signal){socket.emit('BE-accept-call',{signal:signal,to:callerId});});peer.on('disconnect',function(){peer.destroy();});peer.signal(incomingSignal);return peer;}function findPeer(id){return peersRef.current.find(function(p){return p.peerID===id;});}function createUserVideo(peer,index,arr){return/*#__PURE__*/React.createElement(VideoBox,{className:\"width-peer\".concat(peers.length>25?'':peers.length),onClick:expandScreen,key:index},writeUserName(peer.userName),/*#__PURE__*/React.createElement(FaIcon,{className:\"fas fa-expand\"}),/*#__PURE__*/React.createElement(UserName,null,peer.userName),/*#__PURE__*/React.createElement(Options,null,/*#__PURE__*/React.createElement(Close,{className:\"cross-icon\"},\"\\xD7\"),/*#__PURE__*/React.createElement(\"div\",{className:\"booth-btns\"},/*#__PURE__*/React.createElement(Buttons,null,\"Send a gift\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Make small talk\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Send private message\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Mute this person\"))),/*#__PURE__*/React.createElement(VideoCard,{key:index,peer:peer,number:arr.length}));}function writeUserName(userName,index){if(userVideoAudio.hasOwnProperty(userName)){if(!userVideoAudio[userName].video){return/*#__PURE__*/React.createElement(UserName,{key:userName},userName);}}}// Open Chat\nvar clickChat=function clickChat(e){e.stopPropagation();setDisplayChat(displayChat);};// BackButton\nvar goToBack=function goToBack(e){e.preventDefault();socket.emit('BE-leave-room',{roomId:roomId,leaver:currentUser});sessionStorage.removeItem('user');window.location.href='/';};var toggleCameraAudio=function toggleCameraAudio(e){var target=e.target.getAttribute('data-switch');setUserVideoAudio(function(preList){var videoSwitch=preList['localUser'].video;var audioSwitch=preList['localUser'].audio;if(target==='video'){var userVideoTrack=userVideoRef.current.srcObject.getVideoTracks()[0];videoSwitch=!videoSwitch;userVideoTrack.enabled=videoSwitch;}else{var userAudioTrack=userVideoRef.current.srcObject.getAudioTracks()[0];audioSwitch=!audioSwitch;if(userAudioTrack){userAudioTrack.enabled=audioSwitch;}else{userStream.current.getAudioTracks()[0].enabled=audioSwitch;}}return _objectSpread(_objectSpread({},preList),{},{localUser:{video:videoSwitch,audio:audioSwitch}});});socket.emit('BE-toggle-camera-audio',{roomId:roomId,switchTarget:target});};var clickScreenSharing=function clickScreenSharing(){if(!screenShare){navigator.mediaDevices.getDisplayMedia({cursor:true}).then(function(stream){var screenTrack=stream.getTracks()[0];peersRef.current.forEach(function(_ref7){var peer=_ref7.peer;// replaceTrack (oldTrack, newTrack, oldStream);\npeer.replaceTrack(peer.streams[0].getTracks().find(function(track){return track.kind==='video';}),screenTrack,userStream.current);});// Listen click end\nscreenTrack.onended=function(){peersRef.current.forEach(function(_ref8){var peer=_ref8.peer;peer.replaceTrack(screenTrack,peer.streams[0].getTracks().find(function(track){return track.kind==='video';}),userStream.current);});userVideoRef.current.srcObject=userStream.current;setScreenShare(false);};userVideoRef.current.srcObject=stream;screenTrackRef.current=screenTrack;setScreenShare(true);});}else{screenTrackRef.current.onended();}};var expandScreen=function expandScreen(e){var elem=e.target;if(elem.requestFullscreen){elem.requestFullscreen();}else if(elem.mozRequestFullScreen){/* Firefox */elem.mozRequestFullScreen();}else if(elem.webkitRequestFullscreen){/* Chrome, Safari & Opera */elem.webkitRequestFullscreen();}else if(elem.msRequestFullscreen){/* IE/Edge */elem.msRequestFullscreen();}};var clickBackground=function clickBackground(){if(!showVideoDevices)return;setShowVideoDevices(false);};var clickCameraDevice=function clickCameraDevice(event){if(event&&event.target&&event.target.dataset&&event.target.dataset.value){var deviceId=event.target.dataset.value;var enabledAudio=userVideoRef.current.srcObject.getAudioTracks()[0].enabled;navigator.mediaDevices.getUserMedia({video:{deviceId:deviceId},audio:enabledAudio}).then(function(stream){var newStreamTrack=stream.getTracks().find(function(track){return track.kind==='video';});var oldStreamTrack=userStream.current.getTracks().find(function(track){return track.kind==='video';});userStream.current.removeTrack(oldStreamTrack);userStream.current.addTrack(newStreamTrack);peersRef.current.forEach(function(_ref9){var peer=_ref9.peer;// replaceTrack (oldTrack, newTrack, oldStream);\npeer.replaceTrack(oldStreamTrack,newStreamTrack,userStream.current);});});}};//const  widthpeer = peers.length >2 ? 50+\"%\" : 30+\"%\"; \nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RoomContainer,{onClick:clickBackground},/*#__PURE__*/React.createElement(VideoAndBarContainer,null,/*#__PURE__*/React.createElement(VideoContainer,null,/*#__PURE__*/React.createElement(VideoBox,{className:\"width-peer\".concat(peers.length>25?'':peers.length)//style={{width: widthpeer}}\n},userVideoAudio['localUser'].video?null:/*#__PURE__*/React.createElement(UserName,null,currentUser),/*#__PURE__*/React.createElement(FaIcon,{className:\"fas fa-expand\"}),/*#__PURE__*/React.createElement(UserName,null,currentUser),/*#__PURE__*/React.createElement(Options,null,/*#__PURE__*/React.createElement(Close,null,\"\\xD7\"),/*#__PURE__*/React.createElement(\"div\",{className:\"booth-btns\"},/*#__PURE__*/React.createElement(Buttons,null,\"Send a gift\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Make small talk\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Send private message\"),/*#__PURE__*/React.createElement(ButtonsActive,null,\"Mute this person\"))),/*#__PURE__*/React.createElement(MyVideo,{onClick:expandScreen,ref:userVideoRef,muted:true,autoPlay:true,playInline:true})),peers&&peers.map(function(peer,index,arr){return createUserVideo(peer,index,arr);})),/*#__PURE__*/React.createElement(BottomBar,{clickScreenSharing:clickScreenSharing,clickChat:clickChat,clickCameraDevice:clickCameraDevice,goToBack:goToBack,toggleCameraAudio:toggleCameraAudio,userVideoAudio:userVideoAudio['localUser'],screenShare:screenShare,videoDevices:videoDevices,showVideoDevices:showVideoDevices,setShowVideoDevices:setShowVideoDevices})),/*#__PURE__*/React.createElement(Chat,{display:displayChat,roomId:roomId})));};var RoomContainer=styled.div(_templateObject());var VideoContainer=styled.div(_templateObject2());var VideoAndBarContainer=styled.div(_templateObject3());var MyVideo=styled.video(_templateObject4());var VideoBox=styled.div(_templateObject5());var UserName=styled.div(_templateObject6());var FaIcon=styled.i(_templateObject7());var Options=styled.div(_templateObject8());var Close=styled.span(_templateObject9());var Buttons=styled.a(_templateObject10());var ButtonsActive=styled.a(_templateObject11());export default Room;","map":{"version":3,"sources":["/home/kamalesh/Downloads/client/src/components/Room/Room.js"],"names":["React","useState","useEffect","useRef","Peer","styled","socket","VideoCard","BottomBar","Chat","Room","props","currentUser","sessionStorage","getItem","peers","setPeers","localUser","video","audio","userVideoAudio","setUserVideoAudio","videoDevices","setVideoDevices","displayChat","setDisplayChat","screenShare","setScreenShare","showVideoDevices","setShowVideoDevices","peersRef","userVideoRef","screenTrackRef","userStream","roomId","match","params","navigator","mediaDevices","enumerateDevices","then","devices","filtered","filter","device","kind","window","addEventListener","goToBack","getUserMedia","stream","current","srcObject","emit","userName","on","users","forEach","userId","info","peer","createPeer","id","peerID","push","preList","signal","from","peerIdx","findPeer","addPeer","answerId","destroy","user","switchTarget","disconnect","caller","initiator","trickle","userToCall","incomingSignal","callerId","to","find","p","createUserVideo","index","arr","length","expandScreen","writeUserName","hasOwnProperty","clickChat","e","stopPropagation","preventDefault","leaver","removeItem","location","href","toggleCameraAudio","target","getAttribute","videoSwitch","audioSwitch","userVideoTrack","getVideoTracks","enabled","userAudioTrack","getAudioTracks","clickScreenSharing","getDisplayMedia","cursor","screenTrack","getTracks","replaceTrack","streams","track","onended","elem","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","clickBackground","clickCameraDevice","event","dataset","value","deviceId","enabledAudio","newStreamTrack","oldStreamTrack","removeTrack","addTrack","map","RoomContainer","div","VideoContainer","VideoAndBarContainer","MyVideo","VideoBox","UserName","FaIcon","i","Options","Close","span","Buttons","a","ButtonsActive"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport Peer from 'simple-peer';\nimport styled from 'styled-components';\nimport socket from '../../socket';\nimport VideoCard from '../Video/VideoCard';\nimport BottomBar from '../BottomBar/BottomBar';\nimport Chat from '../Chat/Chat';\nimport '../../App.css'\n// import Link from 'react-router-dom';\n\nconst Room = (props) => {\n  const currentUser = sessionStorage.getItem('user');\n  const [peers, setPeers] = useState([]);\n  const [userVideoAudio, setUserVideoAudio] = useState({\n    localUser: { video: true, audio: true },\n  });\n  const [videoDevices, setVideoDevices] = useState([]);\n  const [displayChat, setDisplayChat] = useState(true);\n  const [screenShare, setScreenShare] = useState(false);\n  const [showVideoDevices, setShowVideoDevices] = useState(false);\n  const peersRef = useRef([]);\n  const userVideoRef = useRef();\n  const screenTrackRef = useRef();\n  const userStream = useRef();\n  const roomId = props.match.params.roomId;\n\n  useEffect(() => {\n    // Get Video Devices\n    navigator.mediaDevices.enumerateDevices().then((devices) => {\n      const filtered = devices.filter((device) => device.kind === 'videoinput');\n      setVideoDevices(filtered);\n    });\n\n    // Set Back Button Event\n    window.addEventListener('popstate', goToBack);\n\n    // Connect Camera & Mic\n    navigator.mediaDevices\n      .getUserMedia({ video: true, audio: true })\n      .then((stream) => {\n        userVideoRef.current.srcObject = stream;\n        userStream.current = stream;\n\n        socket.emit('BE-join-room', { roomId, userName: currentUser });\n        socket.on('FE-user-join', (users) => {\n          // all users\n          const peers = [];\n          users.forEach(({ userId, info }) => {\n            let { userName, video, audio } = info;\n\n            if (userName !== currentUser) {\n              const peer = createPeer(userId, socket.id, stream);\n\n              peer.userName = userName;\n              peer.peerID = userId;\n\n              peersRef.current.push({\n                peerID: userId,\n                peer,\n                userName,\n              });\n              peers.push(peer);\n\n              setUserVideoAudio((preList) => {\n                return {\n                  ...preList,\n                  [peer.userName]: { video, audio },\n                };\n              });\n            }\n          });\n\n          setPeers(peers);\n        });\n\n        socket.on('FE-receive-call', ({ signal, from, info }) => {\n          let { userName, video, audio } = info;\n          const peerIdx = findPeer(from);\n\n          if (!peerIdx) {\n            const peer = addPeer(signal, from, stream);\n\n            peer.userName = userName;\n\n            peersRef.current.push({\n              peerID: from,\n              peer,\n              userName: userName,\n            });\n            setPeers((users) => {\n              return [...users, peer];\n            });\n            setUserVideoAudio((preList) => {\n              return {\n                ...preList,\n                [peer.userName]: { video, audio },\n              };\n            });\n          }\n        });\n\n        socket.on('FE-call-accepted', ({ signal, answerId }) => {\n          const peerIdx = findPeer(answerId);\n          peerIdx.peer.signal(signal);\n        });\n\n        socket.on('FE-user-leave', ({ userId, userName }) => {\n          const peerIdx = findPeer(userId);\n          peerIdx.peer.destroy();\n          setPeers((users) => {\n            users = users.filter((user) => user.peerID !== peerIdx.peer.peerID);\n            return [...users];\n          });\n          peersRef.current = peersRef.current.filter(({ peerID }) => peerID !== userId );\n        });\n      });\n\n    socket.on('FE-toggle-camera', ({ userId, switchTarget }) => {\n      const peerIdx = findPeer(userId);\n\n      setUserVideoAudio((preList) => {\n        let video = preList[peerIdx.userName].video;\n        let audio = preList[peerIdx.userName].audio;\n\n        if (switchTarget === 'video') video = !video;\n        else audio = !audio;\n\n        return {\n          ...preList,\n          [peerIdx.userName]: { video, audio },\n        };\n      });\n    });\n\n    return () => {\n      socket.disconnect();\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  function createPeer(userId, caller, stream) {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream,\n    });\n\n    peer.on('signal', (signal) => {\n      socket.emit('BE-call-user', {\n        userToCall: userId,\n        from: caller,\n        signal,\n      });\n    });\n    peer.on('disconnect', () => {\n      peer.destroy();\n    });\n\n    return peer;\n  }\n\n  function addPeer(incomingSignal, callerId, stream) {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream,\n    });\n\n    peer.on('signal', (signal) => {\n      socket.emit('BE-accept-call', { signal, to: callerId });\n    });\n\n    peer.on('disconnect', () => {\n      peer.destroy();\n    });\n\n    peer.signal(incomingSignal);\n\n    return peer;\n  }\n\n  function findPeer(id) {\n    return peersRef.current.find((p) => p.peerID === id);\n  }\n\n  function createUserVideo(peer, index, arr) {\n    return (\n      <VideoBox\n        className={`width-peer${peers.length > 25 ? '' : peers.length}`}\n        onClick={expandScreen}\n        key={index}\n      >\n        {writeUserName(peer.userName)}\n        <FaIcon className='fas fa-expand' />\n        <UserName>{peer.userName}</UserName>\n        <Options>\n            <Close className=\"cross-icon\">×</Close>   \n                    <div className=\"booth-btns\">\n                      <Buttons>\n                        Send a gift\n                      </Buttons>\n                      <ButtonsActive >\n                        Make small talk\n                      </ButtonsActive>\n                      <ButtonsActive>\n                        Send private message\n                      </ButtonsActive>\n                      <ButtonsActive>\n                        Mute this person\n                      </ButtonsActive>\n                    </div>\n                   \n                  </Options>\n\n        <VideoCard key={index} peer={peer} number={arr.length} />\n      </VideoBox>\n    );\n  }\n\n  function writeUserName(userName, index) {\n    if (userVideoAudio.hasOwnProperty(userName)) {\n      if (!userVideoAudio[userName].video) {\n        return <UserName key={userName}>{userName}</UserName>;\n      }\n    }\n  }\n\n  // Open Chat\n  const clickChat = (e) => {\n    e.stopPropagation();\n    setDisplayChat(displayChat);\n  };\n\n  // BackButton\n  const goToBack = (e) => {\n    e.preventDefault();\n    socket.emit('BE-leave-room', { roomId, leaver: currentUser });\n    sessionStorage.removeItem('user');\n    window.location.href = '/';\n  };\n\n  const toggleCameraAudio = (e) => {\n    const target = e.target.getAttribute('data-switch');\n\n    setUserVideoAudio((preList) => {\n      let videoSwitch = preList['localUser'].video;\n      let audioSwitch = preList['localUser'].audio;\n\n      if (target === 'video') {\n        const userVideoTrack = userVideoRef.current.srcObject.getVideoTracks()[0];\n        videoSwitch = !videoSwitch;\n        userVideoTrack.enabled = videoSwitch;\n      } else {\n        const userAudioTrack = userVideoRef.current.srcObject.getAudioTracks()[0];\n        audioSwitch = !audioSwitch;\n\n        if (userAudioTrack) {\n          userAudioTrack.enabled = audioSwitch;\n        } else {\n          userStream.current.getAudioTracks()[0].enabled = audioSwitch;\n        }\n      }\n\n      return {\n        ...preList,\n        localUser: { video: videoSwitch, audio: audioSwitch },\n      };\n    });\n\n    socket.emit('BE-toggle-camera-audio', { roomId, switchTarget: target });\n  };\n\n  const clickScreenSharing = () => {\n    if (!screenShare) {\n      navigator.mediaDevices\n        .getDisplayMedia({ cursor: true })\n        .then((stream) => {\n          const screenTrack = stream.getTracks()[0];\n\n          peersRef.current.forEach(({ peer }) => {\n            // replaceTrack (oldTrack, newTrack, oldStream);\n            peer.replaceTrack(\n              peer.streams[0]\n                .getTracks()\n                .find((track) => track.kind === 'video'),\n              screenTrack,\n              userStream.current\n            );\n          });\n\n          // Listen click end\n          screenTrack.onended = () => {\n            peersRef.current.forEach(({ peer }) => {\n              peer.replaceTrack(\n                screenTrack,\n                peer.streams[0]\n                  .getTracks()\n                  .find((track) => track.kind === 'video'),\n                userStream.current\n              );\n            });\n            userVideoRef.current.srcObject = userStream.current;\n            setScreenShare(false);\n          };\n\n          userVideoRef.current.srcObject = stream;\n          screenTrackRef.current = screenTrack;\n          setScreenShare(true);\n        });\n    } else {\n      screenTrackRef.current.onended();\n    }\n  };\n\n  const expandScreen = (e) => {\n    const elem = e.target;\n\n    if (elem.requestFullscreen) {\n      elem.requestFullscreen();\n    } else if (elem.mozRequestFullScreen) {\n      /* Firefox */\n      elem.mozRequestFullScreen();\n    } else if (elem.webkitRequestFullscreen) {\n      /* Chrome, Safari & Opera */\n      elem.webkitRequestFullscreen();\n    } else if (elem.msRequestFullscreen) {\n      /* IE/Edge */\n      elem.msRequestFullscreen();\n    }\n  };\n\n  const clickBackground = () => {\n    if (!showVideoDevices) return;\n\n    setShowVideoDevices(false);\n  };\n\n  const clickCameraDevice = (event) => {\n    if (event && event.target && event.target.dataset && event.target.dataset.value) {\n      const deviceId = event.target.dataset.value;\n      const enabledAudio = userVideoRef.current.srcObject.getAudioTracks()[0].enabled;\n\n      navigator.mediaDevices\n        .getUserMedia({ video: { deviceId }, audio: enabledAudio })\n        .then((stream) => {\n          const newStreamTrack = stream.getTracks().find((track) => track.kind === 'video');\n          const oldStreamTrack = userStream.current\n            .getTracks()\n            .find((track) => track.kind === 'video');\n\n          userStream.current.removeTrack(oldStreamTrack);\n          userStream.current.addTrack(newStreamTrack);\n\n          peersRef.current.forEach(({ peer }) => {\n            // replaceTrack (oldTrack, newTrack, oldStream);\n            peer.replaceTrack(\n              oldStreamTrack,\n              newStreamTrack,\n              userStream.current\n            );\n          });\n        });\n    }\n  };\n\n  //const  widthpeer = peers.length >2 ? 50+\"%\" : 30+\"%\"; \n\n  return (\n    <>\n    {/* <TopNavigation />  */}\n    <RoomContainer onClick={clickBackground}>\n      \n      <VideoAndBarContainer>\n    \n        <VideoContainer>\n     \n          {/* Current User Video */}\n          <VideoBox\n            className={`width-peer${peers.length > 25 ? '' : peers.length}`}\n            //style={{width: widthpeer}}\n          >\n            {userVideoAudio['localUser'].video ? null : (\n              <UserName>{currentUser}</UserName>\n            )}\n            <FaIcon className='fas fa-expand' />\n            <UserName>{currentUser}</UserName>     \n        \n            <Options>\n            <Close>×</Close>  \n                    <div className=\"booth-btns\">\n                      <Buttons>\n                        Send a gift\n                      </Buttons>\n                      <ButtonsActive>\n                        Make small talk\n                      </ButtonsActive>\n                      <ButtonsActive>\n                        Send private message\n                      </ButtonsActive>\n                      <ButtonsActive>\n                        Mute this person\n                      </ButtonsActive>\n                    </div>\n                   \n                  </Options>\n\n            <MyVideo\n              onClick={expandScreen}\n              ref={userVideoRef}\n              muted\n              autoPlay\n              playInline\n              \n            ></MyVideo>\n          </VideoBox>\n\n\n          {/* Joined User Vidoe */}\n          {peers &&\n            peers.map((peer, index, arr) => createUserVideo(peer, index, arr))\n          }\n\n\n        </VideoContainer>\n\n\n        <BottomBar\n          clickScreenSharing={clickScreenSharing}\n          clickChat={clickChat}\n          clickCameraDevice={clickCameraDevice}\n          goToBack={goToBack}\n          toggleCameraAudio={toggleCameraAudio}\n          userVideoAudio={userVideoAudio['localUser']}\n          screenShare={screenShare}\n          videoDevices={videoDevices}\n          showVideoDevices={showVideoDevices}\n          setShowVideoDevices={setShowVideoDevices}\n        />\n      </VideoAndBarContainer>\n      <Chat display={displayChat} roomId={roomId} />\n    </RoomContainer></>\n  );\n};\n\nconst RoomContainer = styled.div`\n  display: flex;\n  width: 100%;\n  max-height: 100vh;\n  flex-direction: row;\n  height: calc(100vh - 77px)!important;\n  min-height: calc(100vh - 77px)!important;\n  max-height: calc(100vh - 77px)!important;\n  margin-top: 0!important;\n\n@media (max-width:425px){\n  display: block;\n}\n`;\n\nconst VideoContainer = styled.div`\n  max-width: 100%;\n  display: flex;\n  flex-wrap:wrap;\n`;\n\nconst VideoAndBarContainer = styled.div`\n  position: relative;\n  width: 100%;\n  // height:100%!important;\n\n  // @media (max-width:425px){\n    \n  //   height:0%!important;\n\n  // }\n`;\n\nconst MyVideo = styled.video` \n`;\n\nconst VideoBox = styled.div`\n  position: relative;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-items: center;\n  > video {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  :hover {\n  \n    > i,div  {\n      display: block;\n    }\n\n  }\n`;\n\nconst UserName = styled.div`\n  position: absolute;\n  font-size:17px;\n  font-weight:500;\n  color:#fff;\n  width:fit-content;\n  padding:5px;\n  border-radius:5px;\n  margin-left:auto;\n  margin-right:auto;\n  bottom: 5px;\n  @media (max-width:425px){\n    font-size:12px;\n    bottom: 2px;\n    }\n`;\n\nconst FaIcon = styled.i`\n  display: none;\n  position: absolute;\n  cursor:pointer;\n  left: 15px;\n  top: 15px;\n`;\n\nconst Options = styled.div`\nposition: absolute;\ndisplay:none;\n`;\nconst Close = styled.span`\ncolor:yellow;\n`;\nconst Buttons = styled.a`\nfont-size:15px;\nwidth:200px;\npadding:5px;\ncolor:#fff;\ntext-align:center;\nbackground-color: #a833b9;\nborder-radius:50px;\ncursor:pointer;\n:hover {\n    color:#a833b9;\n    background-color: #fff;\n  }\n  @media (max-width:425px){\n    font-size:12px;\n    width:150px;\n    text-align:center;\n    }\n`;\n\nconst ButtonsActive = styled.a`\nfont-size:15px;\nwidth:200px;\npadding:5px;\ncolor: #a833b9;\nbackground-color: #37103d;\nborder:1px solid #a833b9;\ntext-align:center;\nborder-radius:50px;\ncursor:pointer;\n:hover {\n    color:#fff;\n    background-color:#a833b9;  \n\n}\n@media (max-width:425px){\n  font-size:12px;\n  width:150px;\n  text-align:center;\n  }\n`;\n\nexport default Room;"]},"metadata":{},"sourceType":"module"}